<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Kaggle Project: Song BPM Prediction | Daniel Caldwell</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/posts/">Posts</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Kaggle Project: Song BPM Prediction</span></h1>

<h2 class="date">2025/09/23</h2>
</div>

<main>
<h1 id="preliminary-steps-downloading-data">Preliminary Steps (Downloading Data)</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> google.colab <span style="color:#f92672">import</span> userdata
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;KAGGLE_KEY&#34;</span>] <span style="color:#f92672">=</span> userdata<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;KAGGLE_KEY&#39;</span>)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;KAGGLE_USERNAME&#34;</span>] <span style="color:#f92672">=</span> userdata<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;KAGGLE_USERNAME&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>kaggle competitions download <span style="color:#f92672">-</span>c playground<span style="color:#f92672">-</span>series<span style="color:#f92672">-</span>s5e9
</span></span></code></pre></div><pre><code>playground-series-s5e9.zip: Skipping, found more recently modified local copy (use --force to force download)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>unzip playground<span style="color:#f92672">-</span>series<span style="color:#f92672">-</span>s5e9<span style="color:#f92672">.</span>zip
</span></span></code></pre></div><pre><code>Archive:  playground-series-s5e9.zip
replace sample_submission.csv? [y]es, [n]o, [A]ll, [N]one, [r]ename: A
  inflating: sample_submission.csv   
  inflating: test.csv                
  inflating: train.csv               
</code></pre>
<hr>
<h1 id="kaggle-project-song-bpm-prediction">Kaggle Project: Song BPM Prediction</h1>
<p>Another day, another Kaggle project! This time, we&rsquo;re going to be working on a Song BPM prediction project. Let&rsquo;s dive straight in!</p>
<h2 id="examining-the-data">Examining the data</h2>
<p>After accepting the terms of the project, we can take a look at the data we&rsquo;ll be working with. Firstly, we have to load in some of the libraries we&rsquo;ll need for this project</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span></code></pre></div><p>Next, we&rsquo;ll load the data from their CSV files and inspect them.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;train.csv&#39;</span>)
</span></span><span style="display:flex;"><span>test_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;test.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_data<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: right"></th>
          <th style="text-align: right">id</th>
          <th style="text-align: right">RhythmScore</th>
          <th style="text-align: right">AudioLoudness</th>
          <th style="text-align: right">VocalContent</th>
          <th style="text-align: right">AcousticQuality</th>
          <th style="text-align: right">InstrumentalScore</th>
          <th style="text-align: right">LivePerformanceLikelihood</th>
          <th style="text-align: right">MoodScore</th>
          <th style="text-align: right">TrackDurationMs</th>
          <th style="text-align: right">Energy</th>
          <th style="text-align: right">BeatsPerMinute</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: right">0</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">0.60361</td>
          <td style="text-align: right">-7.63694</td>
          <td style="text-align: right">0.0235</td>
          <td style="text-align: right">0.000005</td>
          <td style="text-align: right">0.000001</td>
          <td style="text-align: right">0.051385</td>
          <td style="text-align: right">0.409866</td>
          <td style="text-align: right">290716</td>
          <td style="text-align: right">0.826267</td>
          <td style="text-align: right">147.53</td>
      </tr>
      <tr>
          <td style="text-align: right">1</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">0.639451</td>
          <td style="text-align: right">-16.2676</td>
          <td style="text-align: right">0.07152</td>
          <td style="text-align: right">0.444929</td>
          <td style="text-align: right">0.349414</td>
          <td style="text-align: right">0.170522</td>
          <td style="text-align: right">0.65101</td>
          <td style="text-align: right">164520</td>
          <td style="text-align: right">0.1454</td>
          <td style="text-align: right">136.16</td>
      </tr>
      <tr>
          <td style="text-align: right">2</td>
          <td style="text-align: right">2</td>
          <td style="text-align: right">0.514538</td>
          <td style="text-align: right">-15.9536</td>
          <td style="text-align: right">0.110715</td>
          <td style="text-align: right">0.173699</td>
          <td style="text-align: right">0.453814</td>
          <td style="text-align: right">0.029576</td>
          <td style="text-align: right">0.423865</td>
          <td style="text-align: right">174496</td>
          <td style="text-align: right">0.624667</td>
          <td style="text-align: right">55.3199</td>
      </tr>
      <tr>
          <td style="text-align: right">3</td>
          <td style="text-align: right">3</td>
          <td style="text-align: right">0.734463</td>
          <td style="text-align: right">-1.357</td>
          <td style="text-align: right">0.052965</td>
          <td style="text-align: right">0.001651</td>
          <td style="text-align: right">0.159717</td>
          <td style="text-align: right">0.086366</td>
          <td style="text-align: right">0.278745</td>
          <td style="text-align: right">225567</td>
          <td style="text-align: right">0.487467</td>
          <td style="text-align: right">147.912</td>
      </tr>
      <tr>
          <td style="text-align: right">4</td>
          <td style="text-align: right">4</td>
          <td style="text-align: right">0.532968</td>
          <td style="text-align: right">-13.0564</td>
          <td style="text-align: right">0.0235</td>
          <td style="text-align: right">0.068687</td>
          <td style="text-align: right">0.000001</td>
          <td style="text-align: right">0.331345</td>
          <td style="text-align: right">0.477769</td>
          <td style="text-align: right">213961</td>
          <td style="text-align: right">0.947333</td>
          <td style="text-align: right">89.5851</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_data<span style="color:#f92672">.</span>info()
</span></span></code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 524164 entries, 0 to 524163
Data columns (total 11 columns):
 #   Column                     Non-Null Count   Dtype  
---  ------                     --------------   -----  
 0   id                         524164 non-null  int64  
 1   RhythmScore                524164 non-null  float64
 2   AudioLoudness              524164 non-null  float64
 3   VocalContent               524164 non-null  float64
 4   AcousticQuality            524164 non-null  float64
 5   InstrumentalScore          524164 non-null  float64
 6   LivePerformanceLikelihood  524164 non-null  float64
 7   MoodScore                  524164 non-null  float64
 8   TrackDurationMs            524164 non-null  float64
 9   Energy                     524164 non-null  float64
 10  BeatsPerMinute             524164 non-null  float64
dtypes: float64(10), int64(1)
memory usage: 44.0 MB
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_data<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: left"></th>
          <th style="text-align: right">id</th>
          <th style="text-align: right">RhythmScore</th>
          <th style="text-align: right">AudioLoudness</th>
          <th style="text-align: right">VocalContent</th>
          <th style="text-align: right">AcousticQuality</th>
          <th style="text-align: right">InstrumentalScore</th>
          <th style="text-align: right">LivePerformanceLikelihood</th>
          <th style="text-align: right">MoodScore</th>
          <th style="text-align: right">TrackDurationMs</th>
          <th style="text-align: right">Energy</th>
          <th style="text-align: right">BeatsPerMinute</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">count</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
          <td style="text-align: right">524164</td>
      </tr>
      <tr>
          <td style="text-align: left">mean</td>
          <td style="text-align: right">262081.5</td>
          <td style="text-align: right">0.632843</td>
          <td style="text-align: right">-8.37901</td>
          <td style="text-align: right">0.0744432</td>
          <td style="text-align: right">0.262913</td>
          <td style="text-align: right">0.11769</td>
          <td style="text-align: right">0.178398</td>
          <td style="text-align: right">0.555843</td>
          <td style="text-align: right">241904</td>
          <td style="text-align: right">0.500923</td>
          <td style="text-align: right">119.035</td>
      </tr>
      <tr>
          <td style="text-align: left">std</td>
          <td style="text-align: right">151313.3</td>
          <td style="text-align: right">0.156899</td>
          <td style="text-align: right">4.61622</td>
          <td style="text-align: right">0.0499394</td>
          <td style="text-align: right">0.22312</td>
          <td style="text-align: right">0.131845</td>
          <td style="text-align: right">0.118186</td>
          <td style="text-align: right">0.22548</td>
          <td style="text-align: right">59326.6</td>
          <td style="text-align: right">0.289952</td>
          <td style="text-align: right">26.4681</td>
      </tr>
      <tr>
          <td style="text-align: left">min</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">0.0769</td>
          <td style="text-align: right">-27.5097</td>
          <td style="text-align: right">0.0235</td>
          <td style="text-align: right">0.000005</td>
          <td style="text-align: right">0.000001</td>
          <td style="text-align: right">0.0243</td>
          <td style="text-align: right">0.0256</td>
          <td style="text-align: right">63973</td>
          <td style="text-align: right">0.000067</td>
          <td style="text-align: right">46.718</td>
      </tr>
      <tr>
          <td style="text-align: left">25%</td>
          <td style="text-align: right">131041.</td>
          <td style="text-align: right">0.51585</td>
          <td style="text-align: right">-11.5519</td>
          <td style="text-align: right">0.0235</td>
          <td style="text-align: right">0.069413</td>
          <td style="text-align: right">0.000001</td>
          <td style="text-align: right">0.077637</td>
          <td style="text-align: right">0.403921</td>
          <td style="text-align: right">207099.9</td>
          <td style="text-align: right">0.254933</td>
          <td style="text-align: right">101.07</td>
      </tr>
      <tr>
          <td style="text-align: left">50%</td>
          <td style="text-align: right">262081.5</td>
          <td style="text-align: right">0.634686</td>
          <td style="text-align: right">-8.25249</td>
          <td style="text-align: right">0.066425</td>
          <td style="text-align: right">0.242502</td>
          <td style="text-align: right">0.074247</td>
          <td style="text-align: right">0.166327</td>
          <td style="text-align: right">0.564817</td>
          <td style="text-align: right">243684.1</td>
          <td style="text-align: right">0.5118</td>
          <td style="text-align: right">118.748</td>
      </tr>
      <tr>
          <td style="text-align: left">75%</td>
          <td style="text-align: right">393122.3</td>
          <td style="text-align: right">0.739179</td>
          <td style="text-align: right">-4.91229</td>
          <td style="text-align: right">0.107343</td>
          <td style="text-align: right">0.396957</td>
          <td style="text-align: right">0.204065</td>
          <td style="text-align: right">0.268946</td>
          <td style="text-align: right">0.716633</td>
          <td style="text-align: right">281851.7</td>
          <td style="text-align: right">0.746</td>
          <td style="text-align: right">136.687</td>
      </tr>
      <tr>
          <td style="text-align: left">max</td>
          <td style="text-align: right">524163</td>
          <td style="text-align: right">0.975</td>
          <td style="text-align: right">-1.357</td>
          <td style="text-align: right">0.256401</td>
          <td style="text-align: right">0.995</td>
          <td style="text-align: right">0.869258</td>
          <td style="text-align: right">0.599924</td>
          <td style="text-align: right">0.978</td>
          <td style="text-align: right">464723.2</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">206.037</td>
      </tr>
  </tbody>
</table>
<p>I&rsquo;ve gone ahead and run three methods: info(), head(), and describe() to gein some preliminary insight into our data. Our goal here is to predict the BeatsPerMinute variable, this will be a Regression problem.</p>
<p>I do notice some tiny variables repeating in some columns (5.36e-06, 1.07e-06). This may distort our results, so lets go ahead and smooth these small values out to 0.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>placeholder_cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;AcousticQuality&#39;</span>, <span style="color:#e6db74">&#39;InstrumentalScore&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> placeholder_cols:
</span></span><span style="display:flex;"><span>    train_data[col] <span style="color:#f92672">=</span> train_data[col]<span style="color:#f92672">.</span>replace(<span style="color:#ae81ff">1.07e-06</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Data cleaning complete. Placeholder values have been replaced.&#34;</span>)
</span></span><span style="display:flex;"><span>print(train_data<span style="color:#f92672">.</span>head())
</span></span></code></pre></div><pre><code>Data cleaning complete. Placeholder values have been replaced.
   id  RhythmScore  AudioLoudness  VocalContent  AcousticQuality  \
0   0     0.603610      -7.636942      0.023500         0.000005   
1   1     0.639451     -16.267598      0.071520         0.444929   
2   2     0.514538     -15.953575      0.110715         0.173699   
3   3     0.734463      -1.357000      0.052965         0.001651   
4   4     0.532968     -13.056437      0.023500         0.068687   

   InstrumentalScore  LivePerformanceLikelihood  MoodScore  TrackDurationMs  \
0           0.000000                   0.051385   0.409866      290715.6450   
1           0.349414                   0.170522   0.651010      164519.5174   
2           0.453814                   0.029576   0.423865      174495.5667   
3           0.159717                   0.086366   0.278745      225567.4651   
4           0.000000                   0.331345   0.477769      213960.6789   

     Energy  BeatsPerMinute  
0  0.826267       147.53020  
1  0.145400       136.15963  
2  0.624667        55.31989  
3  0.487467       147.91212  
4  0.947333        89.58511  
</code></pre>
<p>Next up, lets inspect our data and determine if we need to clean or prepare it at all. First, we should check for any null values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_data<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: left"></th>
          <th style="text-align: right">0</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">id</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">RhythmScore</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">AudioLoudness</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">VocalContent</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">AcousticQuality</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">InstrumentalScore</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">LivePerformanceLikelihood</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">MoodScore</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">TrackDurationMs</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">Energy</td>
          <td style="text-align: right">0</td>
      </tr>
      <tr>
          <td style="text-align: left">BeatsPerMinute</td>
          <td style="text-align: right">0</td>
      </tr>
  </tbody>
</table>
<p>Thankfully, there are no null values! We can continue on with distribution and outlier analysis. Let us first examine the distributions of the numeric variables. To do this, we&rsquo;ll use both a Box Plot and Histogram for each variable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>num_features <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>select_dtypes(include<span style="color:#f92672">=</span>[np<span style="color:#f92672">.</span>number])<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>tolist()
</span></span><span style="display:flex;"><span>num_features<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;id&#34;</span>) <span style="color:#75715e"># remove id as it doesn&#39;t provide any data</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_data[num_features]<span style="color:#f92672">.</span>hist(bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>), layout<span style="color:#f92672">=</span>(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#34;Numerical Feature Histograms&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="Song_BPM_Prediction_16_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">20</span>))
</span></span><span style="display:flex;"><span>axes <span style="color:#f92672">=</span> axes<span style="color:#f92672">.</span>flatten()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, col <span style="color:#f92672">in</span> enumerate(num_features):
</span></span><span style="display:flex;"><span>    sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span>train_data[col], ax<span style="color:#f92672">=</span>axes[i])
</span></span><span style="display:flex;"><span>    axes[i]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Box Plot of </span><span style="color:#e6db74">{</span>col<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, len(axes)):
</span></span><span style="display:flex;"><span>    fig<span style="color:#f92672">.</span>delaxes(axes[j])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#34;Box Plots of Numerical Features&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="Song_BPM_Prediction_17_0.png" alt="png"></p>
<p>There&rsquo;s a lot to take in from these charts. Here are a few of my immediate thoughts:</p>
<ul>
<li>BeatsPerMinute: Nearly Normal, Bell-shaped distribution. Perfect for our target variable</li>
<li>Rhythm Score: Bell-shaped</li>
<li>AudioLoudness: Strong peak on the right side of the distribution</li>
<li>VocalContent: Right-skew; Strong peak on the left side</li>
<li>Acousitc Quality: Right-skew towards 0</li>
<li>InstrumentalScore: Right-skew towards 0</li>
<li>LivePerformanceLikelihood: Right-skew;</li>
<li>MoodScore: More spread out distribution</li>
<li>TrackDurationMs: Binomial distribution with two distinct hills</li>
<li>Energy: Uniform distribution between 0-1</li>
</ul>
<p>Many of our numeric variables have a strong concentration of points on one side of the data or the other.</p>
<p>Next up, let&rsquo;s create a correlation matrix and see if there are any correlations between variables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(train_data<span style="color:#f92672">.</span>corr(), annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;coolwarm&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Correlation Matrix&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="Song_BPM_Prediction_19_0.png" alt="png"></p>
<p>Overall, the data has pretty weak linear correlations. A linear regression is unlikely to work in this case, and a non-linear regression approach is likely the answer.</p>
<p>Before, we continue I do want to address some of the feature distributions, such as the left-skewed distribution in AudioLoudness. Let&rsquo;s go ahead and apply a logarithmic transformation to smooth out the shape.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> boxcox
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>min_loudness <span style="color:#f92672">=</span> train_data[<span style="color:#e6db74">&#39;AudioLoudness&#39;</span>]<span style="color:#f92672">.</span>min()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add a constant slightly larger than the absolute minimum to ensure all values are positive</span>
</span></span><span style="display:flex;"><span>constant <span style="color:#f92672">=</span> abs(min_loudness) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the Box-Cox transformation</span>
</span></span><span style="display:flex;"><span>train_data[<span style="color:#e6db74">&#39;AudioLoudness_boxcox&#39;</span>], lambda_audio_loudness <span style="color:#f92672">=</span> boxcox(train_data[<span style="color:#e6db74">&#39;AudioLoudness&#39;</span>] <span style="color:#f92672">+</span> constant)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>histplot(train_data[<span style="color:#e6db74">&#39;AudioLoudness_boxcox&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, kde<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Histogram for Box-Cox Transformed AudioLoudness&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Box-Cox Transformed AudioLoudness&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="Song_BPM_Prediction_21_0.png" alt="png"></p>
<p>The distribution for AudioLoudness looks a bit better now! Lets move on and begin defining and training the model. For this projecft, I&rsquo;m going to train a LightGBM regressor model.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_data[<span style="color:#e6db74">&#34;AudioLoudness&#34;</span>] <span style="color:#f92672">=</span> train_data[<span style="color:#e6db74">&#34;AudioLoudness_boxcox&#34;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> lightgbm <span style="color:#66d9ef">as</span> lgb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BeatsPerMinute&#34;</span>
</span></span><span style="display:flex;"><span>features_list <span style="color:#f92672">=</span> [col <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> train_data<span style="color:#f92672">.</span>columns <span style="color:#66d9ef">if</span> col <span style="color:#f92672">!=</span> target_var]
</span></span><span style="display:flex;"><span>features_list<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;id&#34;</span>)
</span></span><span style="display:flex;"><span>features_list<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;AudioLoudness_boxcox&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X_train <span style="color:#f92672">=</span> train_data[features_list]
</span></span><span style="display:flex;"><span>y_train <span style="color:#f92672">=</span> train_data[target_var]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X_test <span style="color:#f92672">=</span> test_data[features_list]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lgbm_model <span style="color:#f92672">=</span> lgb<span style="color:#f92672">.</span>LGBMRegressor(random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">492</span>)
</span></span><span style="display:flex;"><span>lgbm_model<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span></code></pre></div><pre><code>[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.105526 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 2295
[LightGBM] [Info] Number of data points in the train set: 524164, number of used features: 9
[LightGBM] [Info] Start training from score 119.034899
</code></pre>
<p>And in a couple lines of code, we have trained our model! Now, next up is to create a submission csv.</p>
<p>And in a couple lines of code, we have trained our model! Now, next up is to create a submission csv.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predictions <span style="color:#f92672">=</span> lgbm_model<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>submission_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;id&#39;</span>: test_data[<span style="color:#e6db74">&#39;id&#39;</span>], <span style="color:#e6db74">&#39;BeatsPerMinute&#39;</span>: predictions})
</span></span><span style="display:flex;"><span>submission_df<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#39;submission.csv&#39;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>Submitting our results to Kaggle and we wind up receiving the score: 26.40144. This places us at 1796th place as of the submission! There is a lot more we can perform from here, such as hyperparameter optimization, either by hand or using a library such as FLAML. Additionally, we could look at creating new features that may better predict the data (ex: Energy * Rhythm may prove useful with a correlation of some sort)</p>
<h1 id="thanks-for-reading"><strong>Thanks for Reading!</strong></h1>

</main>

  <footer>
  
  
  <hr/>
  Â© <a href="http://CaldwellDN.duckdns.org">Daniel Caldwell</a> 2025 | <a href="https://github.com/CaldwellDN">Github</a>
  
  </footer>
  </body>
</html>

